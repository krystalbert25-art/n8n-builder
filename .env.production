#!/usr/bin/env bash
# Production Environment Configuration Template
# LinkedIn & Twitter Automation - Pinecone + Gemini APIs
# 
# === SETUP INSTRUCTIONS ===
# 1. Copy this file to .env (at workspace root)
# 2. Replace all placeholder values with actual API keys
# 3. NEVER commit .env to git (add to .gitignore)
# 4. Set appropriate file permissions: chmod 600 .env

# ==========================================
# === GEMINI APIS (Google Cloud)
# ==========================================
# Setup: https://aistudio.google.com/app/apikeys
# Requires: Google Cloud account with Gemini API enabled
# Includes: Embeddings API (768 dimensions) + Text Generation (LLM)
# Cost: ~$0.70/month (with typical usage)

GEMINI_API_KEY=sk-your_gemini_api_key_here_minimum_40_chars
GEMINI_MODEL_EMBEDDINGS=models/embedding-001
GEMINI_MODEL_TEXT=models/gemini-1.5-flash
GEMINI_EMBEDDING_DIMENSION=768
GEMINI_MAX_OUTPUT_TOKENS=500

# ==========================================
# === PINECONE VECTOR DATABASE
# ==========================================
# Setup: https://www.pinecone.io/
# Requires: Create serverless index "linkedin-knowledge-base"
# Specs: 768 dimensions, cosine similarity, AWS us-east-1
# Cost: FREE (100K vectors, 1 index in free tier)

PINECONE_API_KEY=pcsk_your_pinecone_api_key_here_minimum_50_chars
PINECONE_ENVIRONMENT=production
PINECONE_INDEX_NAME=linkedin-knowledge-base
PINECONE_INDEX_DIMENSION=768
PINECONE_METRIC=cosine
PINECONE_TOP_K=5
PINECONE_NAMESPACE_CONTENT=content
PINECONE_NAMESPACE_POSTED=posted_content
PINECONE_NAMESPACE_KNOWLEDGE=knowledge-base

# ==========================================
# === TWITTER API v2 (Data Collection Only)
# ==========================================
# Setup: https://developer.twitter.com/en/portal/dashboard
# Access Level: Essential (Free tier - read-only)
# Note: v2 API write access requires Elevated/Premium tier ($100+/month)
# Workaround: Puppeteer browser automation used for posting (post_to_twitter.js)
# Cost: FREE (with read-only Essential tier)

TWITTER_API_KEY=your_twitter_api_key_here
TWITTER_API_SECRET=your_twitter_api_secret_here
TWITTER_BEARER_TOKEN=AAAAAAAAAAAAAAAAAAAAAIXzBQEAAAAAL2xYZA_here_minimum_120_chars
TWITTER_USER_ID=1234567890
TWITTER_EMAIL=your_twitter_account_email@gmail.com
TWITTER_PASSWORD=your_twitter_password_here_keep_secure
TWITTER_API_ENDPOINT=https://api.twitter.com/2
TWITTER_SEARCH_QUERY=AI OR automation OR llm lang:en -is:retweet
TWITTER_MAX_RESULTS=100

# ==========================================
# === REDDIT API (Trending Discussions)
# ==========================================
# Setup: https://www.reddit.com/prefs/apps
# Create "script" type application
# Cost: FREE

REDDIT_CLIENT_ID=your_reddit_client_id_here
REDDIT_CLIENT_SECRET=your_reddit_client_secret_here
REDDIT_USER_AGENT=MyContentBot/1.0 (by YourUsername)
REDDIT_SUBREDDIT=MachineLearning
REDDIT_SORT=top
REDDIT_TIME_FILTER=day
REDDIT_LIMIT=50

# ==========================================
# === NEWSAPI (Industry News)
# ==========================================
# Setup: https://newsapi.org/register
# Free tier: 100 requests/day
# Cost: FREE for first tier
# Upgrade available at $50/month for higher limits

NEWSAPI_KEY=your_newsapi_key_here_minimum_30_chars
NEWSAPI_ENDPOINT=https://newsapi.org/v2/everything
NEWSAPI_LANGUAGE=en
NEWSAPI_SORT_BY=popularity
NEWSAPI_PAGE_SIZE=50
NEWSAPI_SEARCH_QUERY=AI OR automation OR ChatGPT OR LLM

# ==========================================
# === LINKEDIN API (Official Posting)
# ==========================================
# Setup: https://www.linkedin.com/developers/apps
# Create app and complete OAuth 2.0 authentication
# Scope: w_member_social (write to member feed)
# Cost: FREE (for personal use with rate limits)

LINKEDIN_CLIENT_ID=your_linkedin_client_id_here
LINKEDIN_CLIENT_SECRET=your_linkedin_client_secret_here
LINKEDIN_REDIRECT_URI=http://localhost:3000/callback
LINKEDIN_SCOPES=w_member_social,r_liteprofile
LINKEDIN_ACCESS_TOKEN=AQVwPU_your_oauth_token_here_minimum_50_chars
LINKEDIN_ACCESS_TOKEN_EXPIRY=2025-01-15T10:30:00Z
LINKEDIN_USER_ID=urn:li:person:1234567890
LINKEDIN_ORGANIZATION_ID=optional_if_posting_as_org

# ==========================================
# === EMAIL NOTIFICATIONS (Gmail SMTP)
# ==========================================
# Setup: 
#   1. Enable 2FA on Google account
#   2. Create App Password: https://myaccount.google.com/apppasswords
#   3. Select "Mail" and "Windows Computer" (or custom)
#   4. Copy 16-character password to GMAIL_APP_PASSWORD
# Cost: FREE (for personal Gmail)

NOTIFICATION_EMAIL=your_email@gmail.com
NOTIFICATION_NAME=Content Automation Bot
GMAIL_USER=your_email@gmail.com
GMAIL_APP_PASSWORD=xxxx xxxx xxxx xxxx
GMAIL_SMTP_HOST=smtp.gmail.com
GMAIL_SMTP_PORT=587
GMAIL_FROM_ADDRESS=your_email@gmail.com

# Alert recipients (comma-separated)
ALERT_EMAIL_SUCCESS=your_email@gmail.com,optional_other@gmail.com
ALERT_EMAIL_ERROR=your_email@gmail.com
ENABLE_EMAIL_ALERTS=true

# ==========================================
# === POSTING SCHEDULE & TIMING
# ==========================================
# Times must be in UTC format (HH:MM)
# LinkedIn optimal: Morning wake-up, lunch break, evening wind-down
# Twitter optimal: US business hours + international overlap

TIMEZONE=UTC
SCHEDULE_ENABLED=true
DRYRUN_MODE=false

# LinkedIn posting times (HH:MM UTC)
LINKEDIN_SCHEDULE_TIME_1=08:00
LINKEDIN_SCHEDULE_TIME_2=13:00
LINKEDIN_SCHEDULE_TIME_3=17:00

# Twitter posting times (HH:MM UTC)
TWITTER_SCHEDULE_TIME_1=09:00
TWITTER_SCHEDULE_TIME_2=14:00
TWITTER_SCHEDULE_TIME_3=19:00

# Cron schedule for main trigger (8 AM UTC every day)
MAIN_CRON_SCHEDULE=0 8 * * *

# ==========================================
# === CONTENT GENERATION PARAMETERS
# ==========================================

# LinkedIn post specifications
LINKEDIN_MAX_LENGTH=1300
LINKEDIN_TARGET_LENGTH=300
LINKEDIN_TARGET_LENGTH_MAX=400
LINKEDIN_MIN_HASHTAGS=3
LINKEDIN_MAX_HASHTAGS=5

# Twitter thread specifications  
TWITTER_THREAD_LENGTH_MIN=3
TWITTER_THREAD_LENGTH_MAX=5
TWITTER_MAX_CHARS_PER_TWEET=280
TWITTER_MIN_HASHTAGS=2
TWITTER_MAX_HASHTAGS=4

# Content tone and style
CONTENT_TONE=professional
CONTENT_STYLE=thought-leadership
CONTENT_KEYWORDS=AI,automation,LLM,agent,neural,model

# ==========================================
# === KNOWLEDGE BASE CONFIGURATION
# ==========================================
# RAG system parameters for context retrieval

PINECONE_QUERY_TOP_K=5
KNOWLEDGE_BASE_NAMESPACE=knowledge-base
INCLUDE_SOURCE_IN_CONTEXT=true
MIN_SIMILARITY_SCORE=0.7

# ==========================================
# === SYSTEM & LOGGING CONFIGURATION
# ==========================================

# Log level: DEBUG, INFO, WARN, ERROR
LOG_LEVEL=INFO
LOG_FILE=logs/automation.log
ENABLE_FILE_LOGGING=true
LOG_RETENTION_DAYS=30

# Execution settings
MAX_RETRIES=3
RETRY_DELAY_MS=5000
TIMEOUT_MS=60000
EXECUTE_WORKFLOW_IMMEDIATELY=false

# ==========================================
# === PUPPETEER TWITTER WORKAROUND
# ==========================================
# Used to bypass Twitter API write paywall
# Requires: Chrome/Chromium browser installed locally

PUPPETEER_ENABLED=true
PUPPETEER_HEADLESS=true
PUPPETEER_CHROME_PATH=/usr/bin/chromium-browser
PUPPETEER_BROWSER_TIMEOUT=30000
TWITTER_PUPPETEER_SCRIPT=post_to_twitter.js

# ==========================================
# === DATABASE (Optional - for post history)
# ==========================================
# Alternative to storing in Pinecone only
# Can use PostgreSQL/Supabase for detailed analytics

DATABASE_ENABLED=false
DATABASE_TYPE=sqlite
DATABASE_PATH=./data/posts_history.db
DATABASE_BACKUP=true

# PostgreSQL (if upgrading from SQLite)
# DATABASE_TYPE=postgresql
# DATABASE_HOST=localhost
# DATABASE_PORT=5432
# DATABASE_NAME=content_automation
# DATABASE_USER=postgres
# DATABASE_PASSWORD=your_password

# ==========================================
# === HACKER NEWS API (Optional)
# ==========================================
# Free data collection from Hacker News trending stories
# Cost: FREE

HACKERNEWS_API_ENDPOINT=https://hacker-news.firebaseio.com/v0
HACKERNEWS_ENABLED=true
HACKERNEWS_STORIES_COUNT=30

# ==========================================
# === ANALYTICS & METRICS (Optional)
# ==========================================
# Track performance of posted content

ANALYTICS_ENABLED=false
TRACK_ENGAGEMENT=true
TRACK_IMPRESSIONS=false
ANALYTICS_UPDATE_SCHEDULE=0 18 * * *

# ==========================================
# === SECURITY & ENCRYPTION
# ==========================================
# For production deployments

ENCRYPTION_ENABLED=false
ENCRYPTION_KEY=your_32_char_encryption_key_here
JWT_SECRET=your_jwt_secret_for_api_auth
API_KEY_HEADER=X-API-Key

# ==========================================
# === SLACK INTEGRATION (Optional)
# ==========================================
# Alternative to email notifications

SLACK_ENABLED=false
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#content-automation
SLACK_MENTION_ON_ERROR=@channel
SLACK_MENTION_ON_SUCCESS=

# ==========================================
# === ADVANCED / EXPERIMENTAL
# ==========================================

# A/B testing different prompts
AB_TEST_ENABLED=false
AB_TEST_VARIANT=control

# Custom system prompts (override defaults)
CUSTOM_LINKEDIN_PROMPT=false
CUSTOM_TWITTER_PROMPT=false

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_MS=3600000

# ==========================================
# === DEPLOYMENT ENVIRONMENT
# ==========================================

NODE_ENV=production
ENVIRONMENT=production
DEBUG=false
VERBOSE_OUTPUT=false

# Feature flags
FEATURE_LINKEDIN_CAROUSEL=false
FEATURE_TWITTER_MEDIA=false
FEATURE_ANALYTICS=false

# ==========================================
# === VALIDATION CHECKLIST
# ==========================================
# Before deployment, ensure:
#
# [ ] All API keys filled in (no placeholder values)
# [ ] .env file added to .gitignore
# [ ] File permissions set: chmod 600 .env
# [ ] All required APIs enabled in respective consoles
# [ ] tested at least one successful workflow run
# [ ] Email notifications working
# [ ] Pinecone index created and accessible
# [ ] LinkedIn OAuth completed
# [ ] Twitter user credentials verified (for Puppeteer)
# [ ] Chrome/Chromium installed for Puppeteer
# [ ] Rate limits understood for each free API
# [ ] Cost estimates reviewed
# [ ] Logging configured
# [ ] Error handling configured
#
# ==========================================
# === SUPPORT & TROUBLESHOOTING
# ==========================================
#
# Invalid API Key errors:
#   - Double-check key format and length
#   - Verify key not cut off or wrapped in quotes
#   - Check expiration date in API console
#
# Authentication failures (401/403):
#   - Ensure APIs enabled in respective consoles
#   - Check rate limits not exceeded
#   - Verify OAuth tokens not expired
#   - Re-authenticate LinkedIn if token expired
#
# Missing credentials:
#   - Ensure all required vars above are set
#   - Check .env file is in workspace root
#   - Verify no typos in variable names
#   - Use: source .env && env | grep API to debug
#
# ==========================================
